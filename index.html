<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="Jerry Ren"><meta name="copyright" content="Jerry Ren"><title>JERRY's blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.4.0'
} </script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="JERRY's blog" type="application/atom+xml">
</head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Jerry Ren</div><div class="author-info__description text-center"></div><div class="follow-button"><a target="_blank" rel="noopener" href="https://github.com/USERNAME">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">5</span></a></div></div></div><nav id="nav" style="background-image: url(https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg.jj20.com%2Fup%2Fallimg%2F1114%2F123020113951%2F201230113951-1-1200.jpg&amp;refer=http%3A%2F%2Fimg.jj20.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=jpeg?sec=1644738157&amp;t=0a3e38ccf19424d69fb8678eb1bf7a75.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">JERRY's blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">JERRY's blog</div><div id="site-sub-title"></div><div id="site-social-icons"><a class="social-icon" href="https://github.com" target="_blank" rel="noreferrer noopener nofollow"><i class="fa-github fa"></i></a><a class="social-icon" href="http://weibo.com" target="_blank" rel="noreferrer noopener nofollow"><i class="fa-weibo fa"></i></a><a class="social-icon" href="https://baidu.com" target="_blank" rel="noreferrer noopener nofollow"><i class="fa-rss fa"></i></a></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/24/More-For-Machine-Learning/">No title</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-24</time><div class="content"><p>在上一章博客中我们学习到了一些基本的机器学习的分类计算模型，接下来我们将进行更加深入的学习。</p>
<p><strong>无监督学习</strong>：机器学习的一种方法，训练数据中不带标签，让机器自动寻找数据规律并完成任务。</p>
<p>特点：</p>
<ol>
<li>数据不需要标签。</li>
<li>算法不受监督信息约束。</li>
</ol>
<p>优点：</p>
<ol>
<li>降低数据采集难度，极大程度扩充样本量。</li>
<li>可能发现新的数据规律、被忽略的重要信息。</li>
</ol>
<p><strong>聚类分析</strong>：把数据样本按照一定的方法分成不同的组别，这样让在同一个组别中的成员对象都有相似的一些属性。</p>
<p><strong>K均值聚类</strong>：在样本数据空间中选取K个点作为中心，计算每个样本到各中心的距离，根据距离确定数据类别，是聚类算法中最为基础但也最为重要的算法。</p>
<p><strong>核心流程</strong>：</p>
<ol>
<li>基于要求，观察或经验确定聚类的个数K.</li>
<li>确定K个中心。</li>
<li>计算样本到各中心点距离。</li>
<li>根据距离确定各个样本点所属类别。</li>
<li>计算同类别样本的中心点，并将其设定为新的中心。</li>
<li>重复步骤3-5直到收敛(中心点不再变化)。</li>
</ol>
<p>通过K均值聚类可以实现<strong>图像分割</strong>，<strong>图像分割</strong>就是把图像分成若干个特定的、具有独特性质的区域的技术，是由图像处理到图像分析的关键步骤。</p>
<h4 id="KMeans实现数据聚类："><a href="#KMeans实现数据聚类：" class="headerlink" title="KMeans实现数据聚类："></a>KMeans实现数据聚类：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">data=pd.read_csv(<span class="string">&#x27;task1_data1.csv&#x27;</span>)<span class="comment">#测试样本</span></span><br><span class="line">data_result=pd.read_csv(<span class="string">&#x27;task1_data2.csv&#x27;</span>)<span class="comment">#检验</span></span><br><span class="line">data.head()</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220225111032327.png" alt="image-20220225111032327"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取唯一一个有标签的数据点</span></span><br><span class="line">x_labeled=data.iloc[<span class="number">0</span>,:]<span class="comment">#取第0行的所有数据</span></span><br><span class="line"><span class="built_in">print</span>(x_labeled)</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220225111138082.png" alt="image-20220225111138082"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#x赋值</span></span><br><span class="line">x=data.drop[<span class="string">&#x27;y&#x27;</span>,axis=<span class="number">1</span>]</span><br><span class="line"><span class="comment">#正确结果的赋值</span></span><br><span class="line">y=data_result.loc[;,<span class="string">&#x27;y&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#数据可视化</span></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">fig1=plt.figure()</span><br><span class="line">plt.scatter(x.loc[:,<span class="string">&#x27;x1&#x27;</span>],x.loc[:<span class="string">&#x27;x2&#x27;</span>],label=<span class="string">&#x27;unlabeled&#x27;</span>)</span><br><span class="line">plt.scatter(x_labeled[<span class="string">&#x27;x1&#x27;</span>],x_labeled[<span class="string">&#x27;x2&#x27;</span>]，label=<span class="string">&#x27;labeled&#x27;</span>)<span class="comment">#格式不同，取点方式也不同</span></span><br><span class="line">plt.title(<span class="string">&#x27;unlabeled data&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;x1&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;x2&#x27;</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;upper left&#x27;</span>)<span class="comment">#移动至左上角</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220225112243062.png" alt="image-20220225112243062"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#建立KMeans模型并训练</span></span><br><span class="line"><span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> KMeans</span><br><span class="line">KM=KMeans(n_clusters=<span class="number">2</span>,init=<span class="string">&#x27;random&#x27;</span>,random_state=<span class="number">0</span>)</span><br><span class="line"><span class="comment">#训练</span></span><br><span class="line">KM.fit(x)<span class="comment">#无监督，不用训练y</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看聚类中心</span></span><br><span class="line">centers=KM.cluster_centers_</span><br><span class="line"></span><br><span class="line"><span class="comment">#画中心点</span></span><br><span class="line">plt.scatter(centers[:,<span class="number">0</span>],centers[:,<span class="number">1</span>],<span class="number">100</span>,marker=<span class="string">&#x27;x&#x27;</span>,label=<span class="string">&#x27;centers&#x27;</span>)<span class="comment">#设置大小和标记</span></span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220225203120993.png" alt="image-20220225203120993"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#无监督聚类结果预测</span></span><br><span class="line">y_predict=KM.predict(x)</span><br><span class="line"><span class="built_in">print</span>(pd.value_counts(y_predict)<span class="comment">#统计1和0的数量</span></span><br><span class="line"><span class="built_in">print</span>(pd.value_counts(y))</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220225203751535.png" alt="image-20220225203751535"></p>
<p>由测试数集可以看出，聚类预测的结果由较大的偏差，但也不难看出，可能在分析时，将1和0的分类有可能分反了，因此：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#结果矫正</span></span><br><span class="line">y_corrected=[]<span class="comment">#创建一个新的列表</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> y_predict:</span><br><span class="line">    <span class="keyword">if</span> i==<span class="number">0</span>:</span><br><span class="line">        y_corrected.append(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">elif</span> i==<span class="number">1</span>:</span><br><span class="line">        y_corrected.append(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#可视化</span></span><br><span class="line">y_corrected=np.array(y_corrected)<span class="comment">#转化格式用于画图索引</span></span><br><span class="line">fig2=plt.figure(figsize=(<span class="number">16</span>,<span class="number">8</span>)<span class="comment">#设定图片大小</span></span><br><span class="line"></span><br><span class="line">fig3=plt.subplot(<span class="number">121</span>)</span><br><span class="line">plt.scatter(x.loc[:,<span class="string">&#x27;x1&#x27;</span>][y_corrected==<span class="number">0</span>],x.loc[:<span class="string">&#x27;x2&#x27;</span>][y_corrected==<span class="number">0</span>],label=<span class="string">&#x27;label0&#x27;</span>)</span><br><span class="line">plt.scatter(x_labeled[<span class="string">&#x27;x1&#x27;</span>][y_corrected==<span class="number">1</span>],x_labeled[<span class="string">&#x27;x2&#x27;</span>][y_corrected==<span class="number">1</span>]，label=<span class="string">&#x27;label1&#x27;</span>)</span><br><span class="line">plt.scatter(x_labeled[<span class="string">&#x27;x1&#x27;</span>],x_labeled[<span class="string">&#x27;x2&#x27;</span>],label=<span class="string">&#x27;labeled&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;unlabeled data(corrected result)&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;x1&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;x2&#x27;</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;upper left&#x27;</span>)<span class="comment">#移动至左上角</span></span><br><span class="line"></span><br><span class="line">fig4=plt.subplot(<span class="number">122</span>)</span><br><span class="line">plt.scatter(x.loc[:,<span class="string">&#x27;x1&#x27;</span>][y==<span class="number">0</span>],x.loc[:<span class="string">&#x27;x2&#x27;</span>][y==<span class="number">0</span>],label=<span class="string">&#x27;label0&#x27;</span>)</span><br><span class="line">plt.scatter(x_labeled[<span class="string">&#x27;x1&#x27;</span>][y==<span class="number">1</span>],x_labeled[<span class="string">&#x27;x2&#x27;</span>][y==<span class="number">1</span>]，label=<span class="string">&#x27;label1&#x27;</span>)</span><br><span class="line">plt.scatter(x_labeled[<span class="string">&#x27;x1&#x27;</span>],x_labeled[<span class="string">&#x27;x2&#x27;</span>],label=<span class="string">&#x27;labeled&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;labeled data&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;x1&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;x2&#x27;</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;upper left&#x27;</span>)<span class="comment">#移动至左上角</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220225210356372.png" alt="image-20220225210356372"></p>
<p>接下来，我们运用KNN算法进行建模并于之前的方法进行比较：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#knn建模与训练</span></span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line">knn=KNeighborsClassifier(n_neighbors=<span class="number">3</span>)<span class="comment">#设置k=3</span></span><br><span class="line">knn.fit(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment">#模型预测</span></span><br><span class="line">y_predict_knn=knn.predict(x)</span><br><span class="line"><span class="comment">#通过计算准确率有1.0预测效果好。</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#KMeans迭代一次的结果</span></span><br><span class="line">KM2=KMeans(n_clusters=<span class="number">2</span>,init=<span class="string">&#x27;random&#x27;</span>,random_state=<span class="number">1</span>,n_init=<span class="number">1</span>,max_iter=<span class="number">1</span>)</span><br><span class="line">KM2.fix(x)</span><br><span class="line">centers=KM2.clusters_centers</span><br><span class="line">y_predict2=KM2.predict(x)</span><br></pre></td></tr></table></figure>

<h4 id="KMeans实现图像分割："><a href="#KMeans实现图像分割：" class="headerlink" title="KMeans实现图像分割："></a>KMeans实现图像分割：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#图像的加载与展示</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> skimage <span class="keyword">import</span> io <span class="keyword">as</span> io</span><br><span class="line">img=io.read(<span class="string">&#x27;1.jpg&#x27;</span>)</span><br><span class="line">plt.show(img.)</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220227212737932.png" alt="image-20220227212737932"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#维度存储</span></span><br><span class="line">img_height=img.shape[<span class="number">0</span>]</span><br><span class="line">img_width=img.shape[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#数据维度转化</span></span><br><span class="line">img_data=img.reshape(-<span class="number">1</span>,<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#x赋值</span></span><br><span class="line">x=img_data</span><br><span class="line"></span><br><span class="line"><span class="comment">#模型建立与训练</span></span><br><span class="line"><span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> KMeans</span><br><span class="line">model=KMeans(n_clusters=<span class="number">3</span>,random_state=<span class="number">0</span>)</span><br><span class="line">model.fit(x)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#聚类结果预测</span></span><br><span class="line">label=model.predict(x)</span><br><span class="line"></span><br><span class="line"><span class="comment">#结果数据的维度转化</span></span><br><span class="line">label=label.reshape([img_height,img_width])</span><br><span class="line"></span><br><span class="line"><span class="comment">#后续灰度处理</span></span><br><span class="line">label=<span class="number">1</span>/(label+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#结果可视化</span></span><br><span class="line">plt.imshow(label)</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220227221719584.png" alt="image-20220227221719584"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#图像储存到本地</span></span><br><span class="line">io.imsave(<span class="string">&#x27;result_k3.png&#x27;</span>,label)</span><br><span class="line"></span><br><span class="line"><span class="comment">#改变k值</span></span><br><span class="line">model1=KMeans(n_clusters=<span class="number">4</span>,random_state=<span class="number">0</span>)</span><br><span class="line">model1.fit(x)</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220227221733893.png" alt="image-20220227221733893"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#改变k值</span></span><br><span class="line">model2=KMeans(n_clusters=<span class="number">8</span>,random_state=<span class="number">0</span>)</span><br><span class="line">model2.fit(x)</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220227221744681.png" alt="image-20220227221744681"></p>
<p>由观察可知，k越小的时候，从一个层级到另一个层级过度的较快，轮廓较为清晰，k越大的时候，层级之间的过度较慢，轮廓较为模糊。</p>
<p><strong>异常检测</strong>：根据输入数据，对不匹配预期模式的数据进行识别。</p>
<p><strong>监督式异常检测</strong>：提前使用带“正常”与“异常”标签的数据对模型进行训练，机器基于训练好的模型判断新数据是否为异常数据。</p>
<p><strong>无监督式异常检测</strong>：通过寻找与其他数据最不匹配的实例来检测出未标记测试数据的异常。</p>
<p><strong>数据降维</strong>：在一定的限定条件下，按照一定的规则，尽可能的保留原始数据集重要信息的同时，降低数据集特征的个数。</p>
<p>随着特征数量越来越多，为了避免过拟合，对样本数量的需求会以指数速度增长。</p>
<p>数据降维最常用的方法：<strong>主成分分析(PCA)</strong>,</p>
<p>也称主分量分析，按照一定规则把数据变换到一个新的坐标系统中，使得任何数据<strong>投影</strong>后尽可能可以分开(新数据尽可能不相关，分布方差最大化)。</p>
<p>计算过程：</p>
<ol>
<li>数据预处理(数据分布标准化：u=0，o=1)。</li>
<li>计算协方差矩阵特征向量、及数据在各特征向量投影后的方差。</li>
<li>根据需求(任务指定或方差比例)确定降维维度k。</li>
<li>选取k维特征向量，计算数据在其形成空间的投影。</li>
</ol>
<h4 id="异常消费行为检测："><a href="#异常消费行为检测：" class="headerlink" title="异常消费行为检测："></a>异常消费行为检测：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据加载</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">data=pd.read_csv(<span class="string">&#x27;task1_data.csv&#x27;</span>)</span><br><span class="line">data.head()</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220305142048582.png" alt="image-20220305142048582"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据可视化</span></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">fig1=plt.figure()</span><br><span class="line">plt.scatter(data.loc[:,<span class="string">&#x27;frequency&#x27;</span>],data.loc[:,<span class="string">&#x27;payment&#x27;</span>],marker=<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;raw data&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;frequency&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;payment&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220305143951886.png" alt="image-20220305143951886"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#赋值</span></span><br><span class="line">x=data</span><br><span class="line">x1=data.loc[:,<span class="string">&#x27;frequence&#x27;</span>]</span><br><span class="line">x2=data.loc[:,<span class="string">&#x27;payment&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#数据分布的可视化操作</span></span><br><span class="line">fig2=plt.figure(figsize=(<span class="number">20</span>,<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line">fig2_1=plt.subplot(<span class="number">121</span>)</span><br><span class="line">plt.hist(x1,bins=<span class="number">100</span>)<span class="comment">#柱状图，切割成100份</span></span><br><span class="line">plt.title(<span class="string">&#x27;frequency data&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;frequency&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;counts&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fig2_2=plt.subplot(<span class="number">122</span>)</span><br><span class="line">plt.hist(x2bins=<span class="number">100</span>)<span class="comment">#柱状图，切割成100份</span></span><br><span class="line">plt.title(<span class="string">&#x27;payment data&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;payment&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;counts&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220305223113217.png" alt="image-20220305223113217"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#计算平均值u，以及标准差sigma</span></span><br><span class="line">x1_mean=x1.mean()</span><br><span class="line">x1_sigma=x1.std()</span><br><span class="line"><span class="comment">#x2同理</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#计算基于高斯分布的概率密度函数</span></span><br><span class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> norm</span><br><span class="line">x1_range=np.linspace(<span class="number">0</span>,<span class="number">10</span>,<span class="number">300</span>)<span class="comment">#将0到10分成300份</span></span><br><span class="line">x1_normal=norm.pdf(x1_ramge,x1_mean,x1_sigma)</span><br><span class="line">x2_range=np.linspace(<span class="number">0</span>,<span class="number">400</span>,<span class="number">300</span>)</span><br><span class="line">x2_normal=norm.pdf(x2_range,x2_mean,x2_sigma)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#原始数据的高斯分布概率密度函数的可视化</span></span><br><span class="line">fig3=plt.figure(figsize(<span class="number">20</span>,<span class="number">15</span>))</span><br><span class="line"></span><br><span class="line">fig3_1=plt.subplot(<span class="number">121</span>)</span><br><span class="line">plt.plot(x1_range,x1_normal)</span><br><span class="line">plt.title(<span class="string">&#x27;x1(frequency) Gaussian Distribution&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;x1(frequency)&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;p(x1)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fig3_2=plt.subplot(<span class="number">122</span>)</span><br><span class="line">plt.plot(x2_range,x2_normal)</span><br><span class="line">plt.title(<span class="string">&#x27;x2(payment) Gaussian Distribution&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;x2(payment)&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;p(x2)&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220305225833616.png" alt="image-20220305225833616"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#建立异常检测模型</span></span><br><span class="line"><span class="keyword">from</span> sklearn.covariance <span class="keyword">import</span> EllipticEnvelope</span><br><span class="line">model=EllipticEnvelope(contamination=<span class="number">0.03</span>)</span><br><span class="line">model.fit(x)</span><br><span class="line"></span><br><span class="line"><span class="comment">#模型预测</span></span><br><span class="line">y_predict=model.predict(x)</span><br><span class="line"></span><br><span class="line">plt.scatter(data.loc[:,<span class="string">&#x27;frequency&#x27;</span>][y_predict==<span class="number">1</span>],data.loc[:,<span class="string">&#x27;payment&#x27;</span>][y_predict==<span class="number">1</span>],marker=<span class="string">&#x27;o&#x27;</span>,facecolor=<span class="string">&#x27;none&#x27;</span>,edgecolor=<span class="string">&#x27;red&#x27;</span>,s=<span class="number">150</span>，label=<span class="string">&#x27;anomaly_data&#x27;</span>)<span class="comment">#红色空心和大小</span></span><br><span class="line">plt.legend()</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220306134407329.png" alt="image-20220306134407329"></p>
<p><strong>当contamination=0.2时</strong>：</p>
<p><img src="../pictures/image-20220306134836497.png" alt="image-20220306134836497"></p>
<p>由此可见，当阈值增大时，检测出的异常数据的比例也因此增大。</p>
<h4 id="PCA-逻辑回归预测检查者是否患糖尿病"><a href="#PCA-逻辑回归预测检查者是否患糖尿病" class="headerlink" title="PCA+逻辑回归预测检查者是否患糖尿病"></a>PCA+逻辑回归预测检查者是否患糖尿病</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据加载</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">data=pd.read_csv(<span class="string">&#x27;task2_data.csv&#x27;</span>)</span><br><span class="line">data.head()</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220306162432375.png" alt="image-20220306162432375"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#赋值</span></span><br><span class="line">x=data.drop([<span class="string">&#x27;label&#x27;</span>],axis=<span class="number">1</span>)</span><br><span class="line">y=data.loc[:,<span class="string">&#x27;label&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#逻辑回归模型</span></span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line">model1=LogisticRegression(max_iter=<span class="number">1000</span>)<span class="comment">#更新最大迭代次数</span></span><br><span class="line">model1.fit(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment">#结果预测</span></span><br><span class="line">y_predict=model1.predict(x)</span><br><span class="line"></span><br><span class="line"><span class="comment">#模型评估</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score</span><br><span class="line">accuracy=accutacy_score(y,y_predict)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据标准化</span></span><br><span class="line"><span class="keyword">from</span> sklearn.precessing <span class="keyword">import</span> StandardScaler</span><br><span class="line">x_norm=StandardScaler().fit_transform(x)</span><br><span class="line"></span><br><span class="line"><span class="comment">#计算均值与标准差</span></span><br><span class="line">x1_mean=x.loc[:,<span class="string">&#x27;glucise&#x27;</span>].mean()</span><br><span class="line">x1_norm_mean=x_norm[:,<span class="number">1</span>].mean()<span class="comment">#取第二列，坐标为1，因为格式变化，所以索引方式不同</span></span><br><span class="line">x1_sigma=x.loc[:,<span class="string">&#x27;glucose&#x27;</span>].std()</span><br><span class="line">x1_norm_sigma=x_norm[:,<span class="number">1</span>].std()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#可视化</span></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">fig1=plt.figure(figsize=(<span class="number">12</span>,<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line">fig1_1=plt.subplot(<span class="number">121</span>)</span><br><span class="line">plt.hist(x.loc[:,<span class="string">&#x27;glucose&#x27;</span>],bins=<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">fig1_2=plt.subplot(<span class="number">122</span>)</span><br><span class="line">plt.hist(x_norm[:,<span class="number">1</span>],bins=<span class="number">100</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220306164900034.png" alt="image-20220306164900034"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#pca分析</span></span><br><span class="line"><span class="keyword">from</span> sklearn.decomposition <span class="keyword">import</span> PCA</span><br><span class="line">pca=PCA(n_components=<span class="number">8</span>)</span><br><span class="line">x_pca=pca.fit_transform(x_form)</span><br><span class="line"><span class="comment">#计算分析后各成分的方差以及方差比例</span></span><br><span class="line">var=pca.explained_variance_</span><br><span class="line">var_ratio=pca.explained_variance_ratio_</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#可视化方差比例</span></span><br><span class="line">fig2=plt.figure(figsize=(<span class="number">10</span>,<span class="number">5</span>))</span><br><span class="line">plt.bar([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>],var_ratio)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220306183137392.png" alt="image-20220306183137392"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据降维到2维</span></span><br><span class="line">pca=PCA(n_components=<span class="number">2</span>)</span><br><span class="line">x_pca=pca.fit_transform(x_norm)</span><br><span class="line"><span class="built_in">print</span>(x_pca.shape,x_norm.shape)</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220306185414925.png" alt="image-20220306185414925"></p>
<p>由此可见，通过pca将原本八维的数据降维成了二维。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#降维数据的可视化</span></span><br><span class="line">fig3=plt.figure()</span><br><span class="line">plt.scatter(x_pca[:,<span class="number">1</span>][y==<span class="number">0</span>],x_pca[:,<span class="number">1</span>][y==<span class="number">0</span>],marker=<span class="string">&#x27;x&#x27;</span>,label=<span class="string">&#x27;negative&#x27;</span>)</span><br><span class="line">plt.scatter(x_pca[:,<span class="number">1</span>][y==<span class="number">1</span>],x_pca[:,<span class="number">1</span>][y==<span class="number">1</span>],marker=<span class="string">&#x27;*&#x27;</span>,label=<span class="string">&#x27;positive&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220306193036424.png" alt="image-20220306193036424"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#降维后的模型建立与训练</span></span><br><span class="line">model2=LogisticRegression()</span><br><span class="line">model2.fit(x_pca,y)</span><br><span class="line"></span><br><span class="line"><span class="comment">#模型预测</span></span><br><span class="line">y_predict_pca=model2.predict(x_pca)</span><br><span class="line">accuracy_pca=accuracy_score(y,y_predict_pca)</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/09/Start-Up-For-Machine-Learning/">Start Up For Machine Learning</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-09</time><div class="content"><p><strong>人工智能</strong>，亦称<strong>智机器智能</strong>，指由人制造出来的机器所表现出来的智能。<strong>人工智能</strong>的核心问题包括建构能够跟人类似甚至超卓的推理、知识、规划、学习、交流、感知、移物、使用工具和操控机械的能力等。</p>
<p><strong>机器学习</strong>从数据中自动分析获得规律，并利用规律对未知数据进行预测或用于解决实际问题的方法。</p>
<p>机器学习的应用场景：</p>
<ol>
<li>数据挖掘。</li>
<li>机器视觉。</li>
<li>语言理解。</li>
<li>无人驾驶、机器人。</li>
<li>病例分析。</li>
</ol>
<p>关于<em>sklearn</em>：针对机器学习应用而开发的算法库。常用功能有：数据预处理、分类、回归、降维、模型选择等常用的机器学习算法。</p>
<p>三大优点：</p>
<ol>
<li>丰富的算法模块。</li>
<li>易于安装和使用。</li>
<li>样例丰富、教程文档详细。</li>
</ol>
<p><strong>基于面积的单因子房价预测</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据加载</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">data=pd.read_csv(<span class="string">&#x27;task1_data.csv&#x27;</span>)</span><br><span class="line">data.head()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据可视化</span></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">fig1=plt.figure()</span><br><span class="line">plt.scatter(x,y)<span class="comment">#散点图</span></span><br><span class="line">plt.xlabel(<span class="string">&#x27;size(x)&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;price(y)&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#x,y赋值</span></span><br><span class="line">x=data.loc[:,<span class="string">&#x27;面积&#x27;</span>]<span class="comment">#面积为自变量</span></span><br><span class="line">y=data.loc[:,<span class="string">&#x27;房价&#x27;</span>]<span class="comment">#房价为因变量</span></span><br><span class="line"><span class="built_in">print</span>(x,y)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据格式转化(方便运算)</span></span><br><span class="line">x=np.array(x)</span><br><span class="line">y=np.array(y)</span><br><span class="line"><span class="built_in">print</span>(x.shape,y.shape)</span><br><span class="line"><span class="comment">#将一维变为二维</span></span><br><span class="line">x=x.reshape(-<span class="number">1</span>,<span class="number">1</span>)<span class="comment">#行数不变，列数变为1</span></span><br><span class="line">y=y.reshape(-<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(x.shape,y.shape)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建模型实例</span></span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line">model=LinearRegression()</span><br><span class="line"><span class="comment">#模型训练</span></span><br><span class="line">model.fit(x,y)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取线性回归模型系数</span></span><br><span class="line">a=model.coef_<span class="comment">#斜率</span></span><br><span class="line">b=model.intercept_<span class="comment">#截距</span></span><br><span class="line"><span class="built_in">print</span>(a,b,<span class="string">&quot;y=f(x)=&#123;&#125;*x+&#123;&#125;&quot;</span>.<span class="built_in">format</span>(a[<span class="number">0</span>][<span class="number">0</span>],b[<span class="number">0</span>]))<span class="comment">#ax+b</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#结果预测</span></span><br><span class="line">y_predict=a[<span class="number">0</span>][<span class="number">0</span>]*x+b[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(y_predict)</span><br><span class="line"><span class="comment">#第二种预测的方法</span></span><br><span class="line">y_predict2=model.predict(x)</span><br><span class="line"><span class="built_in">print</span>(y_predict2)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#预测面积为100时，对应的价格</span></span><br><span class="line">X_test=np.array([[<span class="number">100</span>]])<span class="comment">#转换为数组</span></span><br><span class="line">y_test_p=model.predict(X_test)</span><br><span class="line"><span class="built_in">print</span>(y_test_p)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#模型评估</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error,r2_score</span><br><span class="line">MSE=mean_squared_error(y,y_predict)<span class="comment">#均方误差</span></span><br><span class="line">R2=r2_score(y,y_predict)</span><br><span class="line"><span class="built_in">print</span>(MSE,R2)</span><br><span class="line"><span class="comment">#MSE越小越好，R^2越接近1越好</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#预测结果可视化</span></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">fig1=plt.figure()</span><br><span class="line">plt.scatter(x,y,label=<span class="string">&#x27;y_real&#x27;</span>)</span><br><span class="line">plt.plot(x,y_predict,label=<span class="string">&#x27;y_predict&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;size(x)&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;price(y)&#x27;</span>)</span><br><span class="line">plt.legend()<span class="comment">#在图中显示标签</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><strong>多因子房价预测</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据加载</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">data=pd.read_csv(<span class="string">&#x27;task2_data.csv&#x27;</span>)</span><br><span class="line">data.head(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#可视化</span></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">fig=plt.figure(figsize=(<span class="number">20</span>,<span class="number">5</span>))<span class="comment">#设置图片大小</span></span><br><span class="line"></span><br><span class="line">fig1=plt.subplot(<span class="number">131</span>)<span class="comment">#一行三列第一个图</span></span><br><span class="line">plt.scatter(data.loc[:,<span class="string">&#x27;面积&#x27;</span>],data.loc[:,<span class="string">&#x27;价格&#x27;</span>])</span><br><span class="line"></span><br><span class="line">fig2=plt.subplot(<span class="number">132</span>)</span><br><span class="line">plt.scatter(data.loc[:,<span class="string">&#x27;人均收入&#x27;</span>],data.loc[:,<span class="string">&#x27;价格&#x27;</span>])</span><br><span class="line"></span><br><span class="line">fig3=plt.subplot(<span class="number">133</span>)</span><br><span class="line">plt.scatter(data.loc[:,<span class="string">&#x27;平均房龄&#x27;</span>],data.loc[:,<span class="string">&#x27;价格&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220214162319845.png" alt="image-20220214162319845"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#x,y赋值</span></span><br><span class="line">x=data.drop([<span class="string">&#x27;价格&#x27;</span>,axis=<span class="number">1</span>])<span class="comment">#按列剔除价格，取其余列</span></span><br><span class="line">y=data.loc[:,<span class="string">&#x27;价格&#x27;</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#多因子模型建立与训练</span></span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line">model_multi=LinearRegression()</span><br><span class="line">model_multi.fit(x,y)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#多因子模型预测</span></span><br><span class="line">y_predict_multi=model_multi.predict(x)</span><br><span class="line"><span class="comment">#模型评估同上</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#可视化预测结果</span></span><br><span class="line">fig3=plt.figure(figsize(<span class="number">8</span>,<span class="number">5</span>))</span><br><span class="line">plt.scatter(y,y_predict_multi)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;real price&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;predicted price&#x27;</span>)</span><br><span class="line">plt.show</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220214162528945.png" alt="image-20220214162528945"></p>
<p>点集越集中说明模型拟合度越好。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#预测面积=160，人均收入=70000，平均房龄=5的合理房价</span></span><br><span class="line">x_test=np.array([[<span class="number">160</span>,<span class="number">70000</span>,<span class="number">5</span>]])</span><br><span class="line">y_test_predict=model_multi.predict(x_test)</span><br></pre></td></tr></table></figure>

<h4 id="分类任务与逻辑回归"><a href="#分类任务与逻辑回归" class="headerlink" title="分类任务与逻辑回归"></a>分类任务与逻辑回归</h4><p>现实案例如：垃圾短信检测</p>
<p>如何实现：</p>
<ol>
<li>收集一些样本，告诉计算机那些是垃圾信息。</li>
<li>计算机自动寻找垃圾信息共同特征。</li>
<li>在新信息中检测是否包含垃圾信息特征内容，判断其是否为垃圾信息。</li>
<li>部分特征：发件人、是否群发、网址、元、赢、微信、免费等。</li>
</ol>
<p>又如：图像识别，手写数字识别，股票涨跌预测</p>
<p><strong>分类预测</strong>：根据数据类别和部分特征信息，自动寻找类别与特征信息的关系，判断一个新的样本属于那种类别。</p>
<p><strong>逻辑回归实现产品分类</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据加载</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">data=pd.read_csv(<span class="string">&#x27;task1_data.csv&#x27;</span>)</span><br><span class="line">data.head()</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220218233941341.png" alt="image-20220218233941341"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据可视化</span></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">fig1=plt.figure()</span><br><span class="line">plt.scatter(data.loc[:,<span class="string">&#x27;尺寸1&#x27;</span>],data.loc[:,<span class="string">&#x27;尺寸2&#x27;</span>])</span><br><span class="line">plt.title(<span class="string">&#x27;size1-size2&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;size1&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;size2&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220216095652611.png" alt="image-20220216095652611"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#建立一个用于筛选类编的变量</span></span><br><span class="line">mask=data.loc[:,<span class="string">&#x27;y&#x27;</span>]==<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(mask)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#重新数据可视化</span></span><br><span class="line">ok=plt.scatter(data.loc[:,<span class="string">&#x27;尺寸1&#x27;</span>][mask],data.loc[:,<span class="string">&#x27;尺寸2&#x27;</span>][mask])<span class="comment">#正样本</span></span><br><span class="line">ng=plt.scatter(data.loc[:,<span class="string">&#x27;尺寸1&#x27;</span>][~mask],data.loc[:,<span class="string">&#x27;尺寸2&#x27;</span>][~mask])<span class="comment">#反样本</span></span><br><span class="line">plt.title(<span class="string">&#x27;size1-size2&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;size1&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;size2&#x27;</span>)</span><br><span class="line">plt.legend((ok,ng),(<span class="string">&#x27;ok&#x27;</span>,<span class="string">&#x27;ng&#x27;</span>))</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220216112537683.png" alt="image-20220216112537683"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#x,y赋值</span></span><br><span class="line">x=data.drop([<span class="string">&#x27;y&#x27;</span>],axis=<span class="number">1</span>)</span><br><span class="line">y=data.loc[:,<span class="string">&#x27;y&#x27;</span>]</span><br><span class="line">x.head()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建模型实例</span></span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line">model=LogisticRegression()</span><br><span class="line"></span><br><span class="line"><span class="comment">#模型训练</span></span><br><span class="line">model.fit(x,y)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#模型预测</span></span><br><span class="line">y_predict=model.predict(x)</span><br><span class="line">y_test=model.predict([<span class="number">1</span>,<span class="number">10</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;ok&#x27;</span><span class="keyword">if</span> y_test==<span class="number">1</span> <span class="keyword">else</span> <span class="string">&#x27;ng&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>准确率=正确预测样本数量/总样本数量。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#模型评估</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score</span><br><span class="line">accuracy=accuracy_score(y,y_predict)</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220217163930239.png" alt="image-20220217163930239"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#通过边界函数计算边界</span></span><br><span class="line">theta0=model.intercept_</span><br><span class="line">theta1,theta2=model.coef_[<span class="number">0</span>][<span class="number">0</span>],model.coef_[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">x1=data.loc[:,<span class="string">&#x27;尺寸1&#x27;</span>]</span><br><span class="line">x2_new=-(theta0+theta1*x1)/theta2</span><br><span class="line">plt.plot(x1,x2_new)<span class="comment">#边界曲线</span></span><br></pre></td></tr></table></figure>

<p>边界函数如图：</p>
<p><img src="../pictures/image-20220217165339155.png" alt="image-20220217165339155"></p>
<p><strong>商业异常消费数据预测</strong>：线性边界的逻辑回归模型效果并不好，因此要建立二项式边界的逻辑回归模型。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据加载</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data=pd.read_csv(<span class="string">&#x27;task2_data.csv&#x27;</span>)</span><br><span class="line">data.head()</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220221093541661.png" alt="image-20220221093541661"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">数据可视化</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">fig1=plt.figure()</span><br><span class="line">plt.scatter(data.loc[:,<span class="string">&#x27;pay1&#x27;</span>],data.loc[:,<span class="string">&#x27;pay2&#x27;</span>]<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;pay1-pay2&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;pay1&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;pay2&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建mask</span></span><br><span class="line">mask=data.loc[:,<span class="string">&#x27;y&#x27;</span>]==<span class="number">1</span><span class="comment">#等于1则为true</span></span><br><span class="line">fig1=plt.figure()</span><br><span class="line">abnormal=plt.scatter(data.loc[:,<span class="string">&#x27;pay1&#x27;</span>][mask],data.loc[:,<span class="string">&#x27;pay2&#x27;</span>][mask])</span><br><span class="line">normal=plt.scatter(data.loc[:,<span class="string">&#x27;pay1&#x27;</span>][~mask],data.loc[:,<span class="string">&#x27;pay2&#x27;</span>][~mask])</span><br><span class="line"></span><br><span class="line">plt.plot(x1,xw_new)</span><br><span class="line">plt.title(<span class="string">&#x27;pay1-pay2&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;pay1&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;pay2&#x27;</span>)</span><br><span class="line">plt.legend((abnormal,normal),(<span class="string">&#x27;abnormal&#x27;</span>,<span class="string">&#x27;normal&#x27;</span>))</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220217174122101.png" alt="image-20220217174122101"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#x,y赋值</span></span><br><span class="line">x=data.drop([<span class="string">&#x27;y&#x27;</span>],axis=<span class="number">1</span>)</span><br><span class="line">y=data.loc[:,<span class="string">&#x27;y&#x27;</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#生成二阶数据</span></span><br><span class="line">x2=data.loc[:,<span class="string">&#x27;pay2&#x27;</span>]</span><br><span class="line">x1_2=x1*x1<span class="comment">#x1的平方</span></span><br><span class="line">x2_2=x2*x2</span><br><span class="line">x1_x2=x1*x2</span><br><span class="line"></span><br><span class="line"><span class="comment">#创建新的输入数据</span></span><br><span class="line">x_new=&#123;<span class="string">&#x27;x1&#x27;</span>:x1,<span class="string">&#x27;x2&#x27;</span>:x2,<span class="string">&#x27;x1_2&#x27;</span>:x1_2,<span class="string">&#x27;x2_2&#x27;</span>:x2_2,<span class="string">&#x27;x1_x2&#x27;</span>:x1_x2&#125;<span class="comment">#创建一个字典</span></span><br><span class="line">x_new=pd.DataFrame(x_new)<span class="comment">#转化格式</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#建立新模型</span></span><br><span class="line">LR2=logisticRegression()</span><br><span class="line">LR2.fit(x_new,y)</span><br><span class="line"></span><br><span class="line"><span class="comment">#模型预测</span></span><br><span class="line">y2_predict=LR2.predict(x_new)</span><br><span class="line"></span><br><span class="line"><span class="comment">#准确率</span></span><br><span class="line">accuracy2=accuracy_score(y,y2_predict)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取边界函数系数、生成新的边界数据</span></span><br><span class="line">theta0=LR2.intercept_</span><br><span class="line">theta1,theta2,theta3,theta4,theta5=LR2.coef_[<span class="number">0</span>][<span class="number">0</span>],LR2.coef_[<span class="number">0</span>][<span class="number">1</span>],LR2.coef_[<span class="number">0</span>][<span class="number">2</span>],LR2.coef_[<span class="number">0</span>][<span class="number">3</span>],LR2.coef_[<span class="number">0</span>][<span class="number">4</span>]</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220221222531805.png" alt="image-20220221222531805"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a=theta4</span><br><span class="line">b=theta5*x1+theta2</span><br><span class="line">c=theta0+theta1*x1+theta3*x1*x1</span><br><span class="line">x2_new_2=(-b+np.sqrt(b*b-<span class="number">4</span>*a*c))/(<span class="number">2</span>*a)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fig2=plt.figure()</span><br><span class="line">abnormal=plt.scatter(data.loc[:,<span class="string">&#x27;pay1&#x27;</span>][mask],data.loc[:,<span class="string">&#x27;pay2&#x27;</span>][mask])</span><br><span class="line">normal=plt.scatter(data.loc[:,<span class="string">&#x27;pay1&#x27;</span>][~mask],data.loc[:,<span class="string">&#x27;pay2&#x27;</span>][~mask])</span><br><span class="line"></span><br><span class="line">plt.plot(x2,x2_new_2)</span><br><span class="line">plt.title(<span class="string">&#x27;pay1-pay2&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;pay1&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;pay2&#x27;</span>)</span><br><span class="line">plt.legend((abnormal,normal),(<span class="string">&#x27;abnormal&#x27;</span>,<span class="string">&#x27;normal&#x27;</span>))</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220221223033531.png" alt="image-20220221223033531"></p>
<p>此时图像的边界较为杂乱，因为x1的排列并不是按从小到大的顺序进行的，因此解决方案是将x1排序。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#排续</span></span><br><span class="line">x1_new=x1.sort_values()<span class="comment">#从小到大排列</span></span><br><span class="line"><span class="comment">#替换</span></span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220221223329061.png" alt="image-20220221223329061"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#新样本预测 pay1=80,pay2=20</span></span><br><span class="line">x_test=np.array([[<span class="number">80</span>,<span class="number">20</span>,<span class="number">80</span>*<span class="number">80</span>,<span class="number">20</span>*<span class="number">20</span>,<span class="number">80</span>*<span class="number">20</span>]])</span><br><span class="line">y_predict=LR2.predict(x_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;abnormal&#x27;</span> <span class="keyword">if</span> y_predict==<span class="number">1</span> <span class="keyword">else</span> <span class="string">&#x27;normal&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>K近邻分类模型</strong>：通过计算新数据与训练数据之间的距离，然后选取K(K&gt;=1)个距离最近的邻居进行分类判断(K个邻居)，这K个邻居多数属于某个类，就把该数据实例分类到这个类中。</p>
<p><strong>欧氏距离</strong>：两点之间的直线距离，KNN计算中应用最多的距离。</p>
<p><strong>曼哈顿距离</strong>：两个点在标准坐标系上的绝对轴距总和。如图：</p>
<p><img src="../pictures/image-20220222170601294.png" alt="image-20220222170601294"></p>
<p>一般来说，K值越小，分类边界越曲折，抗干扰性更弱(噪声数据影响结果明显)。</p>
<p><strong>信息熵</strong>：是度量随机变量不确定性的指标，熵越大，样本的不确定性就越大。假定当前样本集合D中第K类样本所占比例为<em>Pk</em>，则D的信息熵为：</p>
<p><img src="../pictures/image-20220222212212164.png" alt="image-20220222212212164"></p>
<p><strong>目标</strong>：划分后样本分布不确定性尽可能小，即信息熵小，信息增益大。</p>
<p>概率是反应随机事件出现的可能性大小的量度，而条件概率则是给定某事件A的条件下，另一个事件B发生的概率。全概率公式则是利用条件概率将复杂事件A分割成若干简单事件概率的求和问题。<strong>贝叶斯公式则是利用条件概率和全概率公式计算后验概率</strong>。</p>
<h4 id="决策树判断员工是否适合相关工作："><a href="#决策树判断员工是否适合相关工作：" class="headerlink" title="决策树判断员工是否适合相关工作："></a>决策树判断员工是否适合相关工作：</h4><p>关于一些sklearn中的用法：</p>
<p>criterion=’entropy’：以信息熵的变化作为建立树结构的标准。</p>
<p>min_samples_leaf=5：建立树结构最小分支的样本数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据加载</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">data=pd.read_csv(<span class="string">&#x27;task1_data.csv&#x27;</span>)</span><br><span class="line">data.head()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#x,y赋值</span></span><br><span class="line">x=data.drop([<span class="string">&#x27;y&#x27;</span>],axis=<span class="number">1</span>)</span><br><span class="line">y=data.loc[:,<span class="string">&#x27;y&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#建立决策树模型</span></span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line">model=DecisionTreeClassifier(criterion=<span class="string">&#x27;entropy&#x27;</span>,min_samples_leaf=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#模型预测</span></span><br><span class="line">model.fit(x,y)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#模型预测</span></span><br><span class="line">y_predict=model.predict(x)</span><br><span class="line"><span class="comment">#准确率指标评估</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score</span><br><span class="line">accuracy=accuracy_score(y,y_predict)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#测试样本预测</span></span><br><span class="line">x_test=np.array([[<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>]])</span><br><span class="line">y_test_predict=model.predict(x_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;适合&#x27;</span> <span class="keyword">if</span> y_test_predict==<span class="number">1</span> <span class="keyword">else</span> <span class="string">&#x27;不适合&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#作图</span></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line">fig1=plt.figure(figsize=(<span class="number">200</span>,<span class="number">200</span>))</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> tree</span><br><span class="line">tree.plt_tree(model,filled=<span class="string">&#x27;True&#x27;</span>,feature_names=[<span class="string">&#x27;Skill&#x27;</span>,<span class="string">&#x27;Experience&#x27;</span>,<span class="string">&#x27;Degree&#x27;</span>,<span class="string">&#x27;Income&#x27;</span>],class_names=[<span class="string">&#x27;Unqualified&#x27;</span>,<span class="string">&#x27;Qualified&#x27;</span>])<span class="comment">#filled为填充</span></span><br></pre></td></tr></table></figure>

<p>由于图片比较大，因此将图片保存在本地</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fig1.savefig(<span class="string">&#x27;dc_result.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>为了达到较好的准确度，一般适当提高最小样本叶子树(避免过拟合)。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model2=DecisionTreeClassifier(criterion=<span class="string">&#x27;entropy&#x27;</span>,min_samples_leaf=<span class="number">50</span>)</span><br></pre></td></tr></table></figure>

<p>参考图如下(不全)：</p>
<p><img src="../pictures/image-20220223222354931.png" alt="image-20220223222354931"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#设置字体</span></span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line">mpl.rcParams[<span class="string">&#x27;font.family&#x27;</span>]=<span class="string">&#x27;SimHei&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220223222621219.png" alt="image-20220223222621219"></p>
<h4 id="朴素贝叶斯预测学生录取及奖学金情况："><a href="#朴素贝叶斯预测学生录取及奖学金情况：" class="headerlink" title="朴素贝叶斯预测学生录取及奖学金情况："></a>朴素贝叶斯预测学生录取及奖学金情况：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据加载</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data=pd.read_csv(<span class="string">&#x27;task2_data_csv&#x27;</span>)</span><br><span class="line">data.head()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#x,y赋值</span></span><br><span class="line">x=data.drop([<span class="string">&#x27;y&#x27;</span>,axis=<span class="number">1</span>])</span><br><span class="line">y=data.loc[:,<span class="string">&#x27;y&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#创建朴素贝叶斯模型并训练</span></span><br><span class="line"><span class="keyword">from</span> sklearn.naive_bayes <span class="keyword">import</span> CategoricalNB</span><br><span class="line">model=CategoricalNB()</span><br><span class="line"><span class="comment">#模型训练</span></span><br><span class="line">model.fit(x,y)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#训练数据的概率预测</span></span><br><span class="line">y_predict_prob=model.predict_proba(x)<span class="comment">#每个类别有个对应的概率</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#训练预测</span></span><br><span class="line">y_predict=model.predict(x)</span><br><span class="line"></span><br><span class="line"><span class="comment">#计算模型准确率</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metric <span class="keyword">import</span> accuracy_score</span><br><span class="line">accuracy=accuracy_score(y,y_predict)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#测试样本预测</span></span><br><span class="line">x_test=np.array([[<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>]])</span><br><span class="line">y_test_prob=model.predict_proba(x_test)</span><br><span class="line">y_test_predict=model.predict(x_test)</span><br><span class="line"><span class="comment">#5个测试样本预测</span></span><br><span class="line">x_test=np.array([[<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>],[<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>],[<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>],[<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],[<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]])</span><br><span class="line">y_test_prob=model.predict_proba(x_test)</span><br><span class="line">y_test_predict=model.predict(x_test)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据组合</span></span><br><span class="line">test_data_result=np.concatenate((x_test,y_test_predict_prob,y_test_predict.reshape(<span class="number">5</span>,<span class="number">1</span>)),axis=<span class="number">1</span>)<span class="comment">#axis=1为按列，如果不reshape组合会不能完成</span></span><br><span class="line"><span class="built_in">print</span>(test_data_result)</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220224115946640.png" alt="image-20220224115946640"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#格式转化</span></span><br><span class="line">test_data_result=pd.DataFrame(test_data_result)</span><br><span class="line">test_data_result.head()</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220224153405317.png" alt="image-20220224153405317"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#列名称替换</span></span><br><span class="line">test_data_result.columns=[<span class="string">&#x27;score&#x27;</span>,<span class="string">&#x27;school&#x27;</span>,<span class="string">&#x27;award&#x27;</span>,<span class="string">&#x27;gender&#x27;</span>,<span class="string">&#x27;english&#x27;</span>,<span class="string">&#x27;p0&#x27;</span>,<span class="string">&#x27;p1&#x27;</span>,<span class="string">&#x27;p2&#x27;</span>,<span class="string">&#x27;y_test_predict&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220224153854681.png" alt="image-20220224153854681"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test_data_result.to_csv(<span class="string">&#x27;test_data_result.csv&#x27;</span>)</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/03/Basic-Math-For-AI/">Basic Math For AI</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-03</time><div class="content"><p>在简单的对python有了基础的了解之后，我们的下一步的目标是对机器学习和人工智能进行初步的了解，但是，需要知道的是，机器学习和人工智能中包含着大量的数学知识，如果不对这些基础的知识进行学习，日后的学习中将难以深入一些算法，因此在此处我们先对一些必须的基础数学知识进行了解。</p>
<p>首先我们应该了解到，<strong>人工智能模型</strong>可以被理解成一个<strong>多元函数</strong>，有输入<strong>X</strong>，模型<strong>f(x)<strong>和输出</strong>Y</strong>。如图：</p>
<p><img src="../pictures/image-20220205231110405.png" alt="image-20220205231110405"></p>
<p>其次，我们了解到，对于图片来说，每一个图片都是像素的<strong>三维矩阵</strong>，其中拥有红绿蓝(<em>RGB</em>)的三通道，如图：</p>
<p><img src="../pictures/image-20220206145122283.png" alt="image-20220206145122283"></p>
<p><img src="../pictures/image-20220206145208783.png" alt="image-20220206145208783"></p>
<p>关注，用A矩阵的转置和B矩阵相乘时：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x=np.linspace(<span class="number">1</span>,<span class="number">10</span>,<span class="number">1000</span>)<span class="comment">#将1到10分成1000份</span></span><br><span class="line">A=np.array([[<span class="number">5</span>,<span class="number">2</span>][<span class="number">4</span>,<span class="number">3</span>][<span class="number">1</span>,<span class="number">1</span>]])</span><br><span class="line">B=np.array([[<span class="number">2</span>,<span class="number">7</span>][<span class="number">9</span>,<span class="number">3</span>][<span class="number">1</span>,<span class="number">5</span>]])</span><br><span class="line">np.dot(A.T,B)</span><br><span class="line">np.dot(A,B.T)</span><br></pre></td></tr></table></figure>

<p>有关导数在机器学习中的应用：<strong>梯度下降</strong>,机器学习常常通过梯度下降来对模型函数进行优化。通过向函数上当前点的对应梯度（导数）的反方向的规定的步长距离点进行迭代搜索，直到在极小点收敛。</p>
<p>在深度学习中，如图像识别，大部分的识别结果都是一个<strong>概率</strong>，因此概率与统计也被成为<em>AI模型的评估和优化</em>，其中，我们用<strong>平均值</strong>和<strong>标准差</strong>来评估模型的表现（如猫狗识别）和优化输入数据（如预测房价对输入数据进行归一化）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#生成随机数</span></span><br><span class="line">np.random.randn(<span class="number">10000</span>)<span class="comment">#高斯分布，平均值为0，标准差为1</span></span><br><span class="line">np.random.randn(<span class="number">10000</span>)*<span class="number">2</span><span class="comment">#平均值为0，标准差为2</span></span><br><span class="line">np.random.randn(<span class="number">10000</span>)+<span class="number">1</span><span class="comment">#平均值为1，标准差为1</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tmp=np.random.randn(<span class="number">10000</span>)</span><br><span class="line">np.<span class="built_in">sum</span>(tmp&gt;<span class="number">0</span>)<span class="comment">#接近5000</span></span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220207220907537.png" alt="image-20220207220907537"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#蒙特卡洛近似</span></span><br><span class="line">dots=np.random.rand(<span class="number">10000</span>,<span class="number">2</span>)<span class="comment">#等效为坐标</span></span><br><span class="line"><span class="comment">#随机分布一定位于0到1，而高斯分布则不是。</span></span><br><span class="line">rad=np.sqrt(dots[:,<span class="number">0</span>]**<span class="number">2</span>+dots[:,<span class="number">1</span>]**<span class="number">2</span>)<span class="comment">#通过x,y坐标平方取根求半径</span></span><br><span class="line">np.<span class="built_in">sum</span>(rad&lt;=<span class="number">1</span>)<span class="comment">#可以估算Π</span></span><br></pre></td></tr></table></figure>

<p>接着是机器学习与深度学习的模块，其中，<strong>深度学习</strong>包括：</p>
<ol>
<li>全连接神经网络。</li>
<li>卷积神经网络。</li>
<li>循环神经网络。</li>
</ol>
<p><strong>机器学习</strong>的本质：以数据为驱动，自主的从数据种寻找规律的方法。</p>
<ol>
<li>更少的人为假设和定义。</li>
<li>更灵活的应用。</li>
<li>更高的准确度。</li>
</ol>
<p>通过<strong>机器学习</strong>可以获得<strong>模型</strong>，常见的<strong>机器学习</strong>的方法有：</p>
<ol>
<li>非监督学习。(聚类)</li>
<li>监督学习。(分类，量化预测)</li>
<li>强化学习。(无初始数据)</li>
<li>优化。</li>
</ol>
<p><strong>回归</strong>：根据已有的数据，建立因变量Y和自变量X的定量（函数）关系的模型。</p>
<p>通过<strong>均方误差</strong>来评价回归模型的好坏。</p>
<p>求解线性回归有两个方法，分别是<strong>最小二乘法</strong>和<strong>梯度下降法</strong>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">%pip install sklearn</span><br><span class="line"><span class="keyword">import</span> sklearn</span><br><span class="line">x=np.linspace(<span class="number">1</span>,<span class="number">100</span>,<span class="number">100</span>)</span><br><span class="line">y=<span class="number">5</span>*x+<span class="number">10</span>+<span class="number">10</span>*np.random.randn(<span class="number">100</span>)</span><br><span class="line">plt.plot(x,y,<span class="string">&quot;.k&quot;</span>)<span class="comment">#黑色点图</span></span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220208224733637.png" alt="image-20220208224733637"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line">model=LinearRegression()</span><br><span class="line"></span><br><span class="line">model.fit(x.reshape(<span class="number">100</span>,<span class="number">1</span>),y.reshape(<span class="number">100</span>,<span class="number">1</span>))<span class="comment">#若不进行reshape则无法进行运算</span></span><br><span class="line">y_p=model.predict(x.reshape(<span class="number">100</span>,<span class="number">1</span>))</span><br><span class="line">plt.plot(x,y,<span class="string">&quot;.k&quot;</span>)</span><br><span class="line">plt.plot(x,y_p,<span class="string">&quot;b&quot;</span>)<span class="comment">#蓝线</span></span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220209142350814.png" alt="image-20220209142350814"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#模型预测：</span></span><br><span class="line">model.predict(np.array(<span class="number">10</span>).reshape(<span class="number">1</span>,<span class="number">1</span>))<span class="comment">#注意要进行reshape!</span></span><br></pre></td></tr></table></figure>

<p><strong>读入外部数据多元线性回归</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">data=pd.read_csv(<span class="string">&#x27;data.csv&#x27;</span>)</span><br><span class="line">x=data[:,<span class="number">1</span>:<span class="number">3</span>]<span class="comment">#1至3列</span></span><br><span class="line">y=data[:,<span class="number">3</span>]<span class="comment">#第三列</span></span><br><span class="line"></span><br><span class="line">form sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line">model=LinearRegression()</span><br><span class="line">model.fit(x,y)<span class="comment">#训练</span></span><br><span class="line"></span><br><span class="line">predict=model.predict(x)</span><br><span class="line">plt.plot(y,predict,<span class="string">&quot;.b&quot;</span>)<span class="comment">#真实值为x轴，预测值为y轴</span></span><br></pre></td></tr></table></figure>

<p><img src="../pictures/image-20220209164309337.png" alt="image-20220209164309337"></p>
<p>由此可见拟合度是较好的。</p>
<p>计算误差如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">diff=predict-y</span><br><span class="line">mae=np.mean(np.<span class="built_in">abs</span>(diff))<span class="comment">#平均误差</span></span><br><span class="line">rmse=np.sqrt(np.mean(diff**<span class="number">2</span>))<span class="comment">#均方误差</span></span><br></pre></td></tr></table></figure>

<p>关于<strong>逻辑运算</strong>：<strong>逻辑运算</strong>又称为布尔运算，是通过数学方法研究逻辑问题来建立了逻辑演算。</p>
<p><strong>布尔值</strong>：是(True,1)，否(False,0)</p>
<p><strong>逻辑运算</strong>常用来搭建AI配套模型来实现具体应用。</p>
<p><strong>深度强化学习</strong>：深度强化学习神经网络模型+强化学习方法。</p>
<p><strong>马尔科夫链</strong>：状态空间中经过从一个状态到另一个状态的转换的随机过程，下一状态的概率分布只能由当前状态决定，且与它前面的事件均无关。</p>
<p>数学表达为：</p>
<p><img src="../pictures/image-20220209223825640.png" alt="image-20220209223825640"></p>
<p>假设有三种天气状态（晴天、阴天、下雨），在第二天的状态只取决于前一天的天气状态。</p>
<ol>
<li>第一天晴天，第二天70%晴天，20%阴天，10%下雨。</li>
<li>第一天阴天，第二天40%晴天，40%阴天，20%下雨。</li>
<li>第一天下雨，第二天20%晴天，40%阴天，40%下雨。</li>
</ol>
<p><strong>状态转移矩阵</strong>可写为：</p>
<p><img src="../pictures/image-20220209225144605.png" alt="image-20220209225144605"></p>
<p>用已知概率和状态转移矩阵相乘，可以得到对应的预测的概率。</p>
<p>马尔科夫链<strong>收敛和平稳的条件</strong>：</p>
<ol>
<li>可能的状态数是有限的。</li>
<li>状态间的转移概率需要固定不变。</li>
<li>从任意状态能够转变到任意状态。</li>
<li>不能是简单的循环，例如全是从x到y再从y到x。</li>
</ol>
<p>关于<strong>马尔科夫奖励过程</strong>：<br>马尔科夫过程主要描述的是状态之间的转移关系，在各个状态的转移过程中赋予不同的奖励值就得到了马尔科夫奖励过程。有一个四元组组成(S,P,R,y)</p>
<p>S表示状态集合，P表示状态转移矩阵，R表示奖励函数，y表示衰减因子(0-1)。</p>
<p><strong>马尔科夫决策过程</strong>：相比于马尔科夫奖励过程多了一个动作A，A表示决策过程的集合。</p>
<p><strong>强化学习</strong>的目标就是最大化期望回报，相应的结果就是找到从状态空间S映射到动作空间A的最优策略。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/01/19/Basic-For-Python/">Basic For Python</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-01-19</time><div class="content"><p><strong>python</strong>开发环境的准备：<em>Anaconda</em>,<em>Jupyter Notebook</em>,<em>Spyder</em>。</p>
<p><em>Numpy</em>,<em>Pandas</em>,和<em>Matplotlib</em>的使用也是在<strong>python</strong>学习中非常重要的部分。</p>
<p>本人在按照教程安装完<strong>anaconda</strong>环境以及对应的<strong>ide</strong>：<em>jupyter notebook</em>之后开始正式的<strong>python</strong>的学习。</p>
<p>(<em>注</em>：在本篇博客中，仅对python的各个功能进行最基础的了解。)</p>
<p>首先是python的数据结构列表<strong>list</strong>,元组<strong>tuple</strong>，字典<strong>dict</strong>,集合<strong>set</strong>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#列表</span></span><br><span class="line">l=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="string">&quot;hello&quot;</span>]</span><br><span class="line">l.append(<span class="string">&quot;world&quot;</span>)<span class="comment">#在列表的末尾插入元素</span></span><br><span class="line">l.extend([<span class="string">&quot;a&quot;</span>])<span class="comment">#在列表l末尾增加列表</span></span><br><span class="line">l.insert(<span class="number">0</span>,<span class="string">&quot;lol&quot;</span>)<span class="comment">#在列表指定位置插入元素</span></span><br><span class="line">l.remove(<span class="string">&quot;lol&quot;</span>)<span class="comment">#删除列表中出现的第一个lol</span></span><br><span class="line"><span class="keyword">del</span> l[<span class="number">3</span>]<span class="comment">#删除列表中对应位置的元素</span></span><br><span class="line">l.pop(<span class="number">4</span>)<span class="comment">#删除列表中对应位置的元素</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#特别注意！！</span></span><br><span class="line">a=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line">b=a</span><br><span class="line"><span class="comment">#此时如果对b表进行更改，a表也会随之更改，因此应该设置为：</span></span><br><span class="line">b=a.copy()</span><br><span class="line"></span><br><span class="line"><span class="comment">#元组</span></span><br><span class="line">a=(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"><span class="comment">#元组中的元素不可被更改</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#字典</span></span><br><span class="line">d=&#123;<span class="string">&quot;Name&quot;</span>:<span class="string">&quot;Charlie&quot;</span>,<span class="string">&quot;Job&quot;</span>:<span class="string">&quot;Teacher&quot;</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(d[<span class="string">&quot;Name&quot;</span>])</span><br><span class="line">d[<span class="string">&quot;age&quot;</span>]=<span class="number">25</span><span class="comment">#添加</span></span><br><span class="line"><span class="keyword">del</span> d[<span class="string">&quot;age&quot;</span>]<span class="comment">#删除</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#集合</span></span><br><span class="line"><span class="built_in">set</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">12</span>])</span><br><span class="line"><span class="comment">#set仅保留一次(去重)</span></span><br></pre></td></tr></table></figure>

<p>对于if语句，注意：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> a&lt;b:<span class="comment">#注意有冒号</span></span><br><span class="line">    c=<span class="number">10</span></span><br><span class="line"><span class="keyword">else</span>:<span class="comment">#注意有冒号</span></span><br><span class="line">    c=<span class="number">20</span></span><br></pre></td></tr></table></figure>

<p> 对于循环</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i&lt;<span class="number">10</span>:<span class="comment">#注意有冒号</span></span><br><span class="line">    i=i+<span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"></span><br><span class="line">s=<span class="string">&quot;abcdefg&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure>

<p>关于函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sumoftwo</span>(<span class="params">x,y</span>):</span></span><br><span class="line">    result=x+y</span><br><span class="line">    <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>

<p>文件的IO：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">file=<span class="built_in">open</span>(<span class="string">&quot;text.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)<span class="comment">#注意路径</span></span><br><span class="line">	file.read()</span><br><span class="line">    file.read(<span class="number">100</span>)<span class="comment">#读入元素的个数</span></span><br><span class="line">    file.readline()<span class="comment">#读入行的行数</span></span><br><span class="line">    file.readlines()<span class="comment">#读入所有行</span></span><br><span class="line">file=<span class="built_in">open</span>(<span class="string">&quot;test.txt&quot;</span>,<span class="string">&quot;w&quot;</span>)<span class="comment">#覆盖</span></span><br><span class="line">	file.write(<span class="string">&quot;你好&quot;</span>)</span><br><span class="line">file=<span class="built_in">open</span>(<span class="string">&quot;text.txt&quot;</span>,<span class="string">&quot;a&quot;</span>)<span class="comment">#加入</span></span><br><span class="line">file.close()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">file=<span class="built_in">open</span>(<span class="string">&quot;text.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> file:</span><br><span class="line">    <span class="built_in">print</span>(line)</span><br><span class="line">file.close()</span><br></pre></td></tr></table></figure>

<p>python模块：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line">time.time()<span class="comment">#显示时间从1970年1月1日0时0分0秒到现在</span></span><br><span class="line">time.sleep()<span class="comment">#停留时间</span></span><br><span class="line">time.strftime(<span class="string">&quot;%y-%m-%d %H:%M:%S&quot;</span>)</span><br><span class="line"><span class="comment">#年月日时分秒</span></span><br><span class="line"><span class="keyword">import</span> time <span class="keyword">as</span> t</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> strftime <span class="keyword">as</span> t</span><br><span class="line"><span class="comment">#简写</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.getcwd()<span class="comment">#查看当前文件盘</span></span><br><span class="line">os.listdir()<span class="comment">#查看某文件盘包含的文件</span></span><br><span class="line">os.listdir(os.getcwd())</span><br><span class="line">os.mkdir()<span class="comment">#生成新文件夹</span></span><br></pre></td></tr></table></figure>

<p>异常处理：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line"><span class="keyword">except</span>:</span><br></pre></td></tr></table></figure>

<p>在这里可以等效为c++中的异常处理的的<strong>try</strong>和<strong>catch</strong>。</p>
<p>关于<strong>Numpy</strong>，<strong>Numpy</strong>是一个运行速度非常快的数学库，主要用与数组计算，包含：</p>
<ol>
<li>一个强大的N维数组对象。</li>
<li>广播功能函数。</li>
<li>整合代码的工具。</li>
<li>线性代数、傅里叶变化、随机数生成等功能。</li>
</ol>
<p>接着，本人在按照教程安装完<strong>numpy</strong>环境以及对应的<strong>ide</strong>：<em>spyder</em>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#载入numpy</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment">#定义ndarray</span></span><br><span class="line">a=np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line">b=np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>]])</span><br><span class="line">c=np.array([[<span class="number">1</span>,<span class="number">2.5</span>,<span class="number">3.14</span>][<span class="number">13.1</span>,<span class="number">2.6</span>,<span class="number">1.2</span>]])</span><br><span class="line">d=np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]])<span class="comment">#1*4二维数组</span></span><br><span class="line"><span class="comment">#查看指令</span></span><br><span class="line">a.size</span><br><span class="line">a.shape</span><br><span class="line">b.shape</span><br><span class="line">b.size</span><br><span class="line">b.ndim</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">np.arrange(<span class="number">20</span>)<span class="comment">#生成数字0-19</span></span><br><span class="line">np.linspace(<span class="number">0</span>,<span class="number">9</span>,<span class="number">10</span>)<span class="comment">#生成0-9的浮点数</span></span><br><span class="line">m=np.zeros([<span class="number">5</span>,<span class="number">5</span>])<span class="comment">#生成5*5的全0矩阵</span></span><br><span class="line">m=np.ones([<span class="number">5</span>,<span class="number">5</span>])<span class="comment">#生成5*5的全1矩阵</span></span><br><span class="line">m=np.random.rand(<span class="number">5</span>,<span class="number">5</span>)<span class="comment">#生成5*5的随机矩阵</span></span><br><span class="line">m=np.random.randn(<span class="number">3</span>，<span class="number">3</span>)<span class="comment">#生成3*3的高斯分布</span></span><br></pre></td></tr></table></figure>

<p>有关矩阵的运算：</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">a=np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">b=a.copy()</span><br><span class="line">c=a+b<span class="comment">#[2,4,6]</span></span><br><span class="line">c=a*b<span class="comment">#[1,4,9]</span></span><br><span class="line">d=np.dot(a,b)<span class="comment">#[1,4,9]</span></span><br><span class="line"><span class="comment">#注意reshape元素数量要一致！</span></span><br><span class="line">ax=np.reshape(a,(<span class="number">3</span>,<span class="number">1</span>))<span class="comment">#更改矩阵</span></span><br><span class="line">bx=np.reshape(b,(<span class="number">1</span>,<span class="number">3</span>))</span><br><span class="line">np.dot(ax,bx)<span class="comment">#矩阵乘法3*3</span></span><br><span class="line"></span><br><span class="line">np.vstack()<span class="comment">#竖直方向拼接vertically</span></span><br><span class="line">np.hstack()<span class="comment">#水平方拼接horizontally</span></span><br><span class="line">a.T<span class="comment">#矩阵转置</span></span><br></pre></td></tr></table></figure>

<p>向量和矩阵的索引：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a=np.array([<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>])</span><br><span class="line">a[<span class="number">0</span>:<span class="number">5</span>]<span class="comment">#0，1，2，3，4，从第一个开始第五个结束</span></span><br><span class="line">a[<span class="number">3</span>:]<span class="comment">#3,4,5,6,7,8,9</span></span><br><span class="line">a[<span class="number">3</span>:-<span class="number">1</span>]<span class="comment">#3,4,5,6,7,8</span></span><br><span class="line">a[:<span class="number">3</span>]<span class="comment">#0,1,2</span></span><br><span class="line"></span><br><span class="line">b=a.reshape(<span class="number">5</span>,<span class="number">2</span>)</span><br><span class="line">b[<span class="number">3</span>,<span class="number">0</span>]<span class="comment">#6</span></span><br><span class="line">b[<span class="number">3</span>]<span class="comment">#[6,7]</span></span><br><span class="line">b[:<span class="number">0</span>]<span class="comment">#[0,2,4,6,8]</span></span><br></pre></td></tr></table></figure>

<p>Numpy的常用科学计算：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">np.log(<span class="number">2</span>)<span class="comment">#0.69</span></span><br><span class="line">np.exp(<span class="number">2</span>)<span class="comment">#7.38</span></span><br><span class="line"><span class="comment">#作用与向量、矩阵是一样的</span></span><br><span class="line">np.log(a)<span class="comment">#对a中的每个数都求对数</span></span><br><span class="line">np.<span class="built_in">max</span>(a)<span class="comment">#求a之中最大的数</span></span><br><span class="line">np.mean(a)<span class="comment">#平均数</span></span><br><span class="line">np.median(a)<span class="comment">#中值</span></span><br><span class="line">np.std(a)<span class="comment">#方差</span></span><br><span class="line">np.argmax()<span class="comment">#返回最大值的索引</span></span><br><span class="line">np.argmin()</span><br></pre></td></tr></table></figure>

<p> 生成一个10*10，边界为1，内部为0的矩阵：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">m=np.ones([<span class="number">10</span>,<span class="number">10</span>])</span><br><span class="line">m[<span class="number">1</span>:<span class="number">9</span>,<span class="number">1</span>:<span class="number">9</span>]=<span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>关于<strong>pandas</strong>：<strong>pandas</strong>是为了解决数据分析任务而创建的。<strong>pandas</strong>纳入了大量库和一些标准的数据模型，提供了高效的操作大型数据集所需的工具。</p>
<p>关于<strong>matplotlib</strong>:<strong>matplotlib</strong>是基于python语言的开源项目，旨在为python提供一个数据绘图包，实现专业的绘图功能。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data=pd.DataFrame([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]),columns=[<span class="string">&quot;number&quot;</span>],index=[<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>,<span class="string">&quot;d&quot;</span>]</span><br></pre></td></tr></table></figure>

<p>值得一提的是，<strong>pandas</strong>可以直接导入csv文件。关于<strong>pandas</strong>中的数据预处理：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">data1=pd.read_csv(<span class="string">&#x27;data.csv&#x27;</span>)</span><br><span class="line">data.to_csv(<span class="string">&#x27;data_first.csv&#x27;</span>)</span><br><span class="line">data1.loc[<span class="number">5</span>,<span class="string">&quot;Age&quot;</span>]<span class="comment">#第一个为index,第二个为columns不可输入数字</span></span><br><span class="line">data1.iloc[<span class="number">6</span>,<span class="number">1</span>]<span class="comment">#两个索引都可以是数字</span></span><br><span class="line"></span><br><span class="line">pd.concat([data,data1])</span><br><span class="line">data2=pd.read_csv(<span class="string">&#x27;data.csv&#x27;</span>)</span><br><span class="line">data3=pd.concat([data1,data2])</span><br><span class="line">data4=data3.append([data1,data2])</span><br><span class="line"><span class="comment">#有没有的部分会被设成nan</span></span><br><span class="line">data.isnull()<span class="comment">#判断nan的位置</span></span><br><span class="line"><span class="comment">#True的位置为nan</span></span><br><span class="line">data.dropna()<span class="comment">#删去含有nan的行</span></span><br><span class="line">data.fillna(<span class="number">0</span>)<span class="comment">#将nan值全部填为0</span></span><br></pre></td></tr></table></figure>

<p>关于<strong>pandas</strong>中的常用函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">data.drop(<span class="number">2</span>)<span class="comment">#删去第二行(与index对应)</span></span><br><span class="line">data1[<span class="string">&quot;Age&quot;</span>].mean</span><br><span class="line"><span class="comment">#各种函数同numpy</span></span><br><span class="line">data1.sort_values(by=<span class="string">&quot;Age&quot;</span>)<span class="comment">#根据年龄大小进行排序</span></span><br><span class="line">data1.sort_values(by=<span class="string">&quot;Job&quot;</span>)<span class="comment">#根据首字母的顺序进行排序(a开始)</span></span><br><span class="line"></span><br><span class="line">temp=data3[<span class="string">&quot;Age&quot;</span>].values<span class="comment">#array of float</span></span><br><span class="line">data3[<span class="string">&quot;Age&quot;</span>].describe()<span class="comment">#自动统计,快速查看某一列的统计数据</span></span><br></pre></td></tr></table></figure>

<p>用matplotlib进行画图：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">x=np.linspace(<span class="number">0</span>,<span class="number">10</span>,<span class="number">100</span>)</span><br><span class="line">y=np.six(x)</span><br><span class="line"></span><br><span class="line">plt.plot(x,y)<span class="comment">#将定义的x,y画入图中</span></span><br><span class="line">plt.xlabel(<span class="string">&quot;x&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;y&quot;</span>)</span><br><span class="line">plt.title(<span class="string">&quot;asdf123&quot;</span>)</span><br><span class="line">plt.grid(<span class="literal">True</span>)<span class="comment">#背景网格</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>可画出如下的图案：</p>
<p><img src="../pictures/image-20220130154128301.png" alt="image-20220130154128301"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">y1=np.six(x)</span><br><span class="line">y2=np.exp(x)</span><br><span class="line"></span><br><span class="line">plt.figure()</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>)<span class="comment">#1行2列第一个图</span></span><br><span class="line"><span class="comment">#将两个图分开</span></span><br><span class="line">plt.plot(x,y1,<span class="string">&quot;r&quot;</span>)<span class="comment">#red</span></span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">plt.plot(x,y2,<span class="string">&quot;g&quot;</span>)<span class="comment">#green</span></span><br></pre></td></tr></table></figure>

<p>可画出如下的图案：</p>
<p><img src="../pictures/image-20220130162502084.png" alt="image-20220130162502084"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">plt.xlim()<span class="comment">#显示x轴的区间</span></span><br><span class="line">plt.ylim()<span class="comment">#显示y轴的区间</span></span><br><span class="line"><span class="string">&quot;r.&quot;</span><span class="comment">#只有点</span></span><br><span class="line"><span class="string">&quot;r.-&quot;</span><span class="comment">#点行</span></span><br><span class="line"><span class="string">&quot;r--&quot;</span><span class="comment">#虚线连接</span></span><br><span class="line">plt.imshow()<span class="comment">#展示图片</span></span><br></pre></td></tr></table></figure>

<p>在最后，我们进行简单的网络爬虫的学习。有关<strong>爬虫</strong>：可以自动的获取网页内容的程序，能够高效获得网上的海量数据。</p>
<p>过程如下：</p>
<ol>
<li>通过网址和DNS服务器找到服务器主机。</li>
<li>发送请求获得浏览器结果。</li>
<li>解析获得浏览器呈现的结果。</li>
</ol>
<p>几种常见的爬虫工具：</p>
<ol>
<li>Urllib</li>
<li>Requests(页面级)</li>
<li>Scarpy(网站级)</li>
<li>Selenium</li>
</ol>
<p>对于status_code:</p>
<ol>
<li>2字头：代表请求已经被服务器成功接收和理解。</li>
<li>3字头：重新定向。</li>
<li>4字头：客户端发生错误。</li>
<li>5，6字头：服务器发生错误或异常。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">data=requests.get(<span class="string">&quot;https://www.csdn.net&quot;</span>)</span><br><span class="line">data.encoding=<span class="string">&quot;utf-8&quot;</span><span class="comment">#显示中文</span></span><br><span class="line">data.text<span class="comment">#网站源代码</span></span><br></pre></td></tr></table></figure>

<p>爬虫静态网站实战：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">form bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">url=<span class="comment">#静态网站网址定义</span></span><br><span class="line">header=&#123;<span class="string">&quot;user-agent&quot;</span>:<span class="string">&quot;Mozilla/5.0&quot;</span>&#125;<span class="comment">#反爬机制</span></span><br><span class="line">data=requests.get(url=url,headers=header)</span><br><span class="line">html=data.text</span><br><span class="line"><span class="comment">#可以运用chrome中的开发者工具</span></span><br><span class="line"></span><br><span class="line">soup=BeautifulSoup(html,<span class="string">&quot;lxml&quot;</span>)</span><br><span class="line">lis=soup.find_all(name=<span class="string">&quot;div&quot;</span>,attrs=<span class="string">&quot;id&quot;</span>:<span class="string">&quot;row355&quot;</span>)</span><br><span class="line"></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> li <span class="keyword">in</span> lis:</span><br><span class="line">    temp=li.find(name=<span class="string">&quot;div&quot;</span>,attrs=&#123;<span class="string">&quot;_index&quot;</span>:<span class="built_in">str</span>(i)&#125;)</span><br><span class="line">	i=i+<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(temp.text)</span><br></pre></td></tr></table></figure>





</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/01/14/About-The-Git/">About The Git</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-01-14</time><div class="content"><h2 id="关于git"><a href="#关于git" class="headerlink" title="关于git"></a>关于git</h2><p>在我们运用hexo搭建个人博客的时候，不难发现需要运用到一些关于github仓库的一些知识，因此在这里进行一些基础知识的学习。</p>
<p> 首先，git本身是一种<strong>分布式版本控制</strong>的系统，它没有”中央服务器“，每个人的电脑上都是一个完整的版本库而且具有高安全性。git是一款免费的，开源的分布式版本控制系统，github是用git做版本控制的代码托管平台。</p>
<h3 id="创建远程仓库"><a href="#创建远程仓库" class="headerlink" title="创建远程仓库"></a>创建远程仓库</h3><ol>
<li>确认秘钥的保存路径。</li>
<li>如果上一步置顶的保存路径下已经有秘钥文件，则需要确认是否覆盖。</li>
<li>创建密码。</li>
<li>确认密码。</li>
</ol>
<h3 id="常见命令"><a href="#常见命令" class="headerlink" title="常见命令"></a>常见命令</h3><ol>
<li> git status用于查看工作目录当前状态。</li>
<li> git add用于将修改放入暂存区。(git add.用于所有文件添加)。</li>
<li>  git commit -m用于将代码文件提交到本地仓库。</li>
<li>第一次使用时：git remote add origin+路径，添加远程仓库，仓库名为origin。</li>
<li>git push -u提交到github。</li>
<li>在github上创建-README md。</li>
<li>git pull origin master用于获取远程仓库变动并直接更新到本地仓库中。</li>
</ol>
<h3 id="基本原理"><a href="#基本原理" class="headerlink" title="基本原理"></a>基本原理</h3><p>如图：</p>
<p><img src="../pictures/image-20220116192140249.png"></p>
<p><img src="../pictures/image-20220116192358870.png"></p>
<h3 id="Git版本管理"><a href="#Git版本管理" class="headerlink" title="Git版本管理"></a>Git版本管理</h3><ol>
<li>git log命令显示从最近到最远的提交日志。</li>
<li> git reset –hard HEAD~2回退到前两个版本。</li>
<li>git reflog查看命令历史。</li>
<li>git reset –hard commit_id跳转到对应的版本。</li>
<li>git status查看当前状态。</li>
</ol>
<p><em>ps</em>:这是本人第一次写blog，有很多不足之处，还请大家多多包涵！</p>
</div><hr></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg.jj20.com%2Fup%2Fallimg%2F1114%2F123020113951%2F201230113951-1-1200.jpg&amp;refer=http%3A%2F%2Fimg.jj20.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=jpeg?sec=1644738157&amp;t=0a3e38ccf19424d69fb8678eb1bf7a75.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2021 - 2022 By Jerry Ren</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" data-click="false"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>